在软件开发中遇到问题的时候，我倾向于在不需要阅读源码的情况下解决问题，我会优先去查官方文档、FAQ、google 或 stackoverflow 等网站，去看下有没有前人已经遇到过同类问题。阅读源码来解决问题，算是杀手锏。当然，还有另一种需求，就是希望通过阅读源码了解软件的设计细节，来达到学习的目的，例如，通过阅读Dubbo 的源码，我可以了解一个 RPC 框架的设计细节。

## 前提

阅读源码之前要做一定的准备工作。

首先，确保自己掌握了相关的基础知识，例如，如果你要阅读 Linux 内核源码，要掌握 C 语言的语法、操作系统的基本概念和原理，如果你要阅读 Spring 的源码，要掌握 Java 语言基础、Maven 的使用、一些设计模式等等；

第二，要学会使用这个软件或框架，了解这个软件或框架的使用场景，有什么功能，同类竞品有哪些，在学习使用软件或框架的过程中，最重要的参考资料是官方文档，一款优质的软件或框架，官方文档一般包括三块：快速开始，即一些 demo；参考文档，最详细的文档，包括概念、特性的解读；FAQ：对于使用者来说常见的问题的解答；

第三，初步了解代码的整体组织结构，每个文件夹是做什么用的。

## 调试环境

调试环境非常重要，有了调试环境，就可以根据需要进行断点，对阅读源码非常有帮助。至于说如何搭建调试环境，不同的情况有不同的处理办法，例如 MAT 的源码，我是先将它的核心逻辑剥离出来，然后自己用单元测试进行调试；对于 Dubbo 源码，我则是写了一个 Dubbo 服务提供者、一个 Dubbo 服务消费者，以及安装了 ZK 之后才搭建起来的；对于 Spring 最简单了，利用 Spring Boot 启动一个 hello word 的 demo 就可以。

## 场景阅读

在做完上述准备工作后，我会按照使用功能或场景来阅读源码，例如，在阅读 MAT（内存分析工具）的源码的时候，我是按照以下几个步骤来阅读：文件解析、索引创建、类直方图查询、支配树查询、线程视图查询等等；在阅读 Spring 源码的时候，我会按照 Spring 容器的启动、IoC 的工作过程、AOP 的工作过程、静态属性的引入等功能来阅读；在阅读 Dubbo 源码的时候，我会按照服务发布、服务订阅、服务调用三个主要场景进行源码阅读。按照功能或场景阅读，可以让我们从整体上对代码有所理解，然后就可以进入自己关注的一些细节了，例如：在 MAT中，索引文件是如何创建的，在 Dubbo 中，请求的超时机制和心跳机制是如何实现的。

## 总结

阅读源码的过程中，我总结出了一些需要注意的点：

1. 自顶向下阅读，先把握整体的、大的流程，然后再根据需要切入到对应的分支
2. 忽略一些细节，例如参数的检查、错误的处理、数据形式的转换和存储
3. 尽量准备好调试环境
4. 要关注核心的业务逻辑或算法
5. 最好能在阅读的过程中输出一些笔记或文档，例如模块划分图、函数的流程图、针对某个业务场景，在几个模块之间的时序图等等，这些文档可以先手写，然后再形成电子版存档。